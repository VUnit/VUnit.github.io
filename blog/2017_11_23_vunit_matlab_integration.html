<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="author" title="About these documents" href="../about.html" /><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="VUnit 3.0 - While Waiting for VHDL-2017" href="2017_11_07_vunit_3_0_while_waiting_for_vhdl_2017.html" /><link rel="prev" title="VUnit BFMs - as Simple as Emailing" href="2017_12_14_vunit_bfms_as_simple_as_emailing.html" />

    <link rel="shortcut icon" href="../_static/vunit.ico"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.08.06 -->
        <title>VUnit Matlab Integration - VUnit documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">VUnit  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/VUnit_logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Blog</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Blog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="2023_08_26_vhdl_configurations.html">Improved Support for VHDL Configurations and OSVVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="2023_04_01_vunit_phases.html">VUnit Phases</a></li>
<li class="toctree-l2"><a class="reference internal" href="2023_03_31_vunit_events.html">VUnit Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="2022_09_19_vunit_user_conference.html">VUnit User Conference</a></li>
<li class="toctree-l2"><a class="reference internal" href="2022_09_06_vunit_and_other_frameworks.html">FAQ What is VUnit’s Relation to Other Verification Frameworks?</a></li>
<li class="toctree-l2"><a class="reference internal" href="2020_08_12_continuous_integration_with_vunit_action_in_10_lines_of_code.html">Continuous Integration With VUnit Action in 10 Lines of Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018_09_22_sigasi_adds_full_vunit_support.html">Sigasi Adds Full VUnit Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018_07_22_sigasi_deepens_its_commitment_to_the_vunit_testing_framework.html">Sigasi Deepens Its Commitment to the VUnit Testing Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018_03_22_vunit_community_developed_bfms.html">VUnit Community Developed BFMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="2018_02_12_vunit3.html">VUnit 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_12_14_vunit_bfms_as_simple_as_emailing.html">VUnit BFMs - as Simple as Emailing</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">VUnit Matlab Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_11_07_vunit_3_0_while_waiting_for_vhdl_2017.html">VUnit 3.0 - While Waiting for VHDL-2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_10_31_vunit_3_0_color_logging.html">VUnit 3.0 Color Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_09_28_sigasi_adds_support_for_vunit_testing_framework.html">Sigasi Adds Support for VUnit Testing Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_06_03_enable_your_simulator_to_handle_complex_top_level_generics.html">Enable Your Simulator to Handle Complex Top-Level Generics</a></li>
<li class="toctree-l2"><a class="reference internal" href="2017_01_12_vunit_getting_started_1_2_3.html">VUnit - Getting Started 1-2-3</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_11_22_vunit_the_best_value_for_initial_effort_part3.html">VUnit - The Best Value for Initial Effort - Part 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_11_16_vunit_the_best_value_for_initial_effort_part2.html">VUnit - The Best Value for Initial Effort - Part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_11_15_vunit_the_best_value_for_initial_effort_part1.html">VUnit - The Best Value for Initial Effort - Part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_08_08_making_osvvm_a_submodule.html">Making OSVVM a Git Submodule</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_02_21_improving_vhdl_testbench_design_with_message_passing.html">Improving VHDL Testbench Design with Message Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_02_01_website_updates.html">Website Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_01_29_chat_with_vunit_users_and_developers.html">Chat with VUnit Users and Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="2016_01_26_welcome_to_our_new_website.html">Welcome to Our New Website</a></li>
<li class="toctree-l2"><a class="reference internal" href="2015_12_15_free_and_open_source_verification_with_vunit_and_ghdl.html">Free and Open Source Verification with VUnit and GHDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="2015_10_08_who_is_using_UVM.html">Who’s Using UVM (or Not) for FPGA Development, and Why?</a></li>
<li class="toctree-l2"><a class="reference internal" href="2015_09_24_short_introduction_to_vunit.html">Short Introduction to VUnit</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">What is VUnit?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testimonials/testimonials.html">Testimonials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../id/user_guide.html">Identity Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging/user_guide.html">Logging Library User Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../check/user_guide.html">Check Library User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Check Library User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../check/check_api.html"><em>check</em> package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../check/checker_pkg.html"><em>checker</em> package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../run/user_guide.html">Run Library User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../com/user_guide.html">Communication Library User Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../verification_components/user_guide.html">Verification Components User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Verification Components User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../verification_components/memory_model.html">Memory Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verification_components/vci.html">Bus Master VCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verification_components/vci.html#stream-master-vci">Stream Master VCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verification_components/vci.html#stream-slave-vci">Stream Slave VCI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../verification_components/vci.html#synchronization-vci">Synchronization VCI</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_types/user_guide.html">Data Types User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Data Types User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_types/event_user_guide.html">VUnit Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_types/queue.html"><em>queue</em> package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_types/integer_array.html"><em>integer_array</em> package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_types/ext_string.html"><em>external string</em> package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_types/ext_integer_vector.html"><em>external integer vector</em> package</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line Interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../py/ui.html">Python Interface</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Python Interface</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../py/vunit.html">vunit.ui</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py/opts.html">Compilation Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py/opts.html#simulation-options">Simulation Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hdl_libraries.html">HDL Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Continuous Integration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ci/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/script.html">Setup/configuration scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/container.html">Containers and/or Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/manual.html">Manual setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci/usecases.html">Practical use cases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/VUnit/vunit/blob/master/docs/blog/2017_11_23_vunit_matlab_integration.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/VUnit/vunit/edit/master/docs/blog/2017_11_23_vunit_matlab_integration.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="vunit-matlab-integration">
<h1>VUnit Matlab Integration<a class="headerlink" href="#vunit-matlab-integration" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article was originally posted on <a class="reference external" href="https://www.linkedin.com/pulse/vunit-matlab-integration-lars-asplund/">LinkedIn</a>
where you may find some comments on its contents.</p>
</div>
<figure class="align-center">
<img alt="VUnit Matlab Integration" src="../_images/vunit_matlab.jpg" />
</figure>
<p>Recently I got a question from an ASIC team if it is possible to
integrate their VUnit simulations with Matlab. I’ve been getting this
question several times lately so this post will show you how it can be
done. It will be based on their use case but hopefully it will serve
as inspiration if you have other Matlab use cases or want to integrate
VUnit with some other program.</p>
<section id="the-testbench">
<h2>The Testbench<a class="headerlink" href="#the-testbench" title="Link to this heading">¶</a></h2>
<p>The ASIC team had a slow high-level testbench that they wanted to
monitor by continuously visualizing the progress of the implemented
algorithm in the form of a Matlab plot. To emulate that slow test I
created a testbench which doesn’t have a DUT implementing an algorithm
but simply generates a sequence of output samples itself. The output
samples are generated by repeatedly calling a function
<cite>get_output_sample</cite> that I made really slow by adding an internal delay
loop. The samples generated form a simple ramp function as shown in
the figure below.</p>
<figure class="align-center">
<img alt="Testbench Progress" src="../_images/matlab_figure.jpg" />
</figure>
<p>Here is the main loop of my VUnit testbench.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="nc">test_runner</span><span class="o">:</span><span class="w"> </span><span class="k">process</span><span class="w"> </span><span class="k">is</span>
<span class="w">  </span><span class="k">variable</span><span class="w"> </span><span class="n">data_set</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">integer_array_t</span><span class="p">;</span>
<span class="k">begin</span>
<span class="w">  </span><span class="n">test_runner_setup</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span><span class="w"> </span><span class="n">runner_cfg</span><span class="p">);</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">num_of_data_sets</span><span class="w"> </span><span class="k">loop</span>
<span class="w">    </span><span class="n">data_set</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">new_1d</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">size_of_data_set</span><span class="w"> </span><span class="k">loop</span>
<span class="w">      </span><span class="n">append</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span><span class="w"> </span><span class="n">get_output_sample</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">loop</span><span class="p">;</span>

<span class="w">    </span><span class="n">save_csv</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span><span class="w"> </span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">(</span><span class="n">runner_cfg</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;data_set_&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">to_string</span><span class="p">(</span><span class="n">set</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s">&quot;.csv&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="n">deallocate</span><span class="p">(</span><span class="n">data_set</span><span class="p">);</span>
<span class="w">  </span><span class="k">end</span><span class="w"> </span><span class="k">loop</span><span class="p">;</span>

<span class="w">  </span><span class="n">test_runner_cleanup</span><span class="p">(</span><span class="n">runner</span><span class="p">);</span>
<span class="k">end</span><span class="w"> </span><span class="k">process</span><span class="p">;</span>
</pre></div>
</div>
<p>The code consists of two nested loops. The inner loop creates a
<cite>data_set</cite> with a number of output samples and the outer loop creates
several such sets. The samples in a data set is the latest progress of
my algorithm, the “progress report” I send to Matlab.</p>
<p><cite>data_set</cite> is declared as an <cite>integer_array_t</cite> from VUnit’s
<cite>integer_array_pkg</cite>. This package allows you to manage one-, two- or
three-dimensional arrays of integers and provides procedures for
storing such arrays on file. Some of you may have seen the VUnit
<cite>array_t</cite> before. <cite>integer_array_t</cite> is basically the same thing but
it’s a regular type rather than a protected type. The reasons for this
were discussed in my previous <a class="reference external" href="https://www.linkedin.com/pulse/vunit-30-while-waiting-vhdl-2017-lars-asplund/?lipi=urn%3Ali%3Apage%3Ad_flagship3_pulse_read%3B5b9rV7igQdWD8WMA5ZZshg%3D%3D">post</a>.</p>
<p>In this case I have a one-dimensional array (a vector) created by</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">new_1d</span><span class="p">;</span>
</pre></div>
</div>
<p>The created vector is empty by default and grows dynamically with every new sample I append.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="n">append</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span><span class="w"> </span><span class="n">get_output_sample</span><span class="p">);</span>
</pre></div>
</div>
<p>Once I have a complete data set I save that to a CSV file and then
deallocate the data set such that I can repeat the procedure.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="n">save_csv</span><span class="p">(</span><span class="n">data_set</span><span class="p">,</span><span class="w"> </span><span class="n">file_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">(</span><span class="n">runner_cfg</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;data_set_&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">to_string</span><span class="p">(</span><span class="n">set</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s">&quot;.csv&quot;</span><span class="p">));</span>
<span class="n">deallocate</span><span class="p">(</span><span class="n">data_set</span><span class="p">);</span>
</pre></div>
</div>
<p>The file name probably deserves a comment. <cite>output_path(runner_cfg)</cite> returns a test unique output directory that VUnit provides to the testbench via the ever-present <cite>runner_cfg</cite> generic. I assign a unique name to every CSV file based on the data set number, for example <cite>data_set_3.csv</cite>, and then create the full path by concatenating the directory and file names using the <cite>join</cite> function.</p>
</section>
<section id="the-run-script">
<h2>The Run Script<a class="headerlink" href="#the-run-script" title="Link to this heading">¶</a></h2>
<p>The run script is similar to most run scripts with a few additions</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prj</span> <span class="o">=</span> <span class="n">VUnit</span><span class="o">.</span><span class="n">from_argv</span><span class="p">()</span>
<span class="n">prj</span><span class="o">.</span><span class="n">add_array_util</span><span class="p">()</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">lib</span> <span class="o">=</span> <span class="n">prj</span><span class="o">.</span><span class="n">add_library</span><span class="p">(</span><span class="s2">&quot;lib&quot;</span><span class="p">)</span>
<span class="n">lib</span><span class="o">.</span><span class="n">add_source_files</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;*.vhd&quot;</span><span class="p">))</span>
<span class="n">tb_octave</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s2">&quot;tb_octave&quot;</span><span class="p">)</span>

<span class="n">tb_octave</span><span class="o">.</span><span class="n">add_config</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Passing test&quot;</span><span class="p">,</span>
                     <span class="n">generics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size_of_data_set</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">num_of_data_sets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">activate_bug</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                     <span class="n">pre_config</span><span class="o">=</span><span class="n">make_pre_config</span><span class="p">(</span><span class="s2">&quot;Passing test&quot;</span><span class="p">,</span> <span class="n">num_of_data_sets</span><span class="p">))</span>

<span class="n">prj</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The VUnit array support is an add-on not compiled into <cite>vunit_lib</cite> by
default. To include it you have to add</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="n">prj</span><span class="p">.</span><span class="n">add_array_util</span><span class="p">()</span>
</pre></div>
</div>
<p>Next I want to create a configuration for my testbench. A VUnit configuration allows me to run my testbench with several different settings. In this example my testbench entity is called <cite>tb_octave</cite> and I get the testbench, compiled into <cite>lib</cite>, with the line</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tb_octave</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s2">&quot;tb_octave&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <cite>add_config</cite> method I can now add a configuration to the
testbench which I named <cite>Passing test</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tb_octave</span><span class="o">.</span><span class="n">add_config</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Passing test&quot;</span><span class="p">,</span>
                     <span class="n">generics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size_of_data_set</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">num_of_data_sets</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">activate_bug</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                     <span class="n">pre_config</span><span class="o">=</span><span class="n">make_pre_config</span><span class="p">(</span><span class="n">plot_title</span><span class="o">=</span><span class="s2">&quot;Passing test&quot;</span><span class="p">,</span> <span class="n">num_of_data_sets</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>The configuration first sets a number of testbench generics collected
in a Python dictionary (a list of key/value pairs). You’ve already
seen the purpose of <cite>size_of_data_set</cite> and <cite>num_of_data_sets</cite> but I
also have a generic <cite>activate_bug</cite> which I will use later to activate
a bug in the <cite>get_output_sample</cite> function. I’ve also added something
called a <cite>pre_config</cite> function. This is a function that VUnit calls
before starting the simulation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pre_config</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">run</span><span class="p">([</span><span class="s2">&quot;octave&quot;</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;octave&quot;</span><span class="p">,</span> <span class="s2">&quot;visualize.m&quot;</span><span class="p">),</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">plot_title</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_of_data_sets</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p><cite>pre_config</cite> takes a mandatory <cite>output_path</cite> argument which is the
same directory we saw in the testbench before. Note that the
<cite>output_path</cite> name doesn’t mean that it can’t be used for simulation
input. A <cite>pre_config</cite> function can for example be used to generate and
store an input data file in <cite>output_path</cite> and let the testbench read
that data.</p>
<p>In this example I use <cite>pre_config</cite> to call Matlab (or rather Octave
which is a free Matlab clone) using the Python <cite>run</cite> function. Octave
is called with a Matlab M script, <cite>visualize.m</cite>, located in the
<cite>&lt;root&gt;/octave</cite> directory. The script takes three arguments - the
output path where the testbench stores the CSV files to plot, the
title of the plot to be created, and the number of data sets that
Octave should expect.</p>
<p>But where are <cite>plot_title</cite> and <cite>num_of_data_sets</cite> defined? <cite>pre_config</cite> is called by VUnit and it can only provide arguments it knows about. VUnit knows about the <cite>output_path</cite> it created but doesn’t know anything about the purpose of the <cite>pre_config</cite> function and what it needs to fulfill that purpose. I can hardcode these values but what if I want to reuse <cite>pre_config</cite> with different values? The trick is to generate the <cite>pre_config</cite> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_pre_config</span><span class="p">(</span><span class="n">plot_title</span><span class="p">,</span> <span class="n">num_of_data_sets</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pre_config</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">run</span><span class="p">([</span><span class="s2">&quot;octave&quot;</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;octave&quot;</span><span class="p">,</span> <span class="s2">&quot;visualize.m&quot;</span><span class="p">),</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">plot_title</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_of_data_sets</span><span class="p">)])</span>

        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">pre_config</span>
</pre></div>
</div>
<p>The <cite>make_pre_config</cite> function has defined <cite>pre_config</cite> locally and
returns that function to the caller of <cite>make_pre_config</cite>. Since
<cite>figure_title</cite> and <cite>num_of_data_sets</cite> are arguments to
<cite>make_pre_config</cite> they are also visible for <cite>pre_config</cite>, just like
they would be for a local function in VHDL. It might seem strange that
<cite>pre_config</cite> remembers the values of these arguments once the function
has been returned and is used elsewhere. This is known as a closure
and you can read more about it <a class="reference external" href="https://en.wikipedia.org/wiki/Closure_(computer_programming)">here</a>.</p>
</section>
<section id="the-matlab-script">
<h2>The Matlab Script<a class="headerlink" href="#the-matlab-script" title="Link to this heading">¶</a></h2>
<p>I’m not a Matlab programmer but the reference manual helped me creating a script that seems to work. Based on the input arguments it creates a named plot and then waits for input files in the output directory. Every new file is read and appended to the plot. I also added a test to see if the plotted graph is monotonically increasing as intended. If so, the script creates an empty file named <cite>pass</cite>. If not, a file named <cite>fail</cite> is created.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Parse arguments</span>
<span class="n">arg_list</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">argv</span><span class="p">;</span>
<span class="n">output_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">arg_list</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span>
<span class="n">plot_title</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">arg_list</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span>
<span class="n">num_of_data_sets</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">arg_list</span><span class="p">{</span><span class="mi">3</span><span class="p">};</span>

<span class="c">% Configure figure</span>
<span class="n">fig</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">figure</span><span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Testbench Progress&#39;</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span>
<span class="nb">xlim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">100</span><span class="p">])</span>
<span class="nb">ylim</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">100</span><span class="p">])</span>
<span class="nb">hold</span><span class="w"> </span><span class="n">on</span>

<span class="c">% Wait on data set files and plot</span>
<span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[];</span>
<span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">str2num</span><span class="p">(</span><span class="n">num_of_data_sets</span><span class="p">)</span>
<span class="w">  </span><span class="n">file_name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span><span class="w"> </span><span class="nb">strcat</span><span class="p">(</span><span class="s">&quot;data_set_&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">int2str</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;.csv&quot;</span><span class="p">));</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="n">not</span><span class="p">(</span><span class="nb">exist</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;file&#39;</span><span class="p">))</span>
<span class="w">    </span><span class="nb">pause</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">data_set</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">csvread</span><span class="p">(</span><span class="n">file_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">data_set</span><span class="p">];</span>
<span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<span class="k">end</span>

<span class="c">% Verify that the data set is monotonically increasing</span>
<span class="k">if</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">data</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fopen</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pass&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span>
<span class="k">else</span>
<span class="w">  </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fopen</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fail&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;w&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nb">disp</span><span class="p">(</span><span class="s">&quot;ERROR: Output is not monotonically increasing!&quot;</span><span class="p">)</span>
<span class="k">end</span>
<span class="nb">fclose</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

<span class="c">% Quit when figure is closed</span>
<span class="nb">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">waitfor</span><span class="p">(</span><span class="n">fig</span><span class="p">);</span>
</pre></div>
</div>
<p>The next step is to let the pass/fail files determine the faith of my
testbench. This can be done with a VUnit <cite>post_check</cite> function. I
works just like the <cite>pre_config</cite> function but runs after the
testbench.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">post_check</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">exists</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;pass&quot;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">exists</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>If a pass file is found within 10 seconds the function returns <cite>True</cite>,
otherwise <cite>False</cite>. A <cite>pre_config</cite> or <cite>post_check</cite> function returning <cite>False</cite>
will cause my test to fail just like a failing assert within my
testbench would.</p>
</section>
<section id="putting-it-all-together">
<h2>Putting It All Together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">¶</a></h2>
<p>To demonstrate both the passing and the failing case I’ve created two
configurations for this testbench using a for loop. Note how
<cite>make_pre_config</cite> allows me to reuse the <cite>pre_config</cite> function with
different values for <cite>plot_title</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">size_of_data_set</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_of_data_sets</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">activate_bug</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">&quot;Passing test&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Failing test&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)]:</span>
    <span class="n">tb_octave</span><span class="o">.</span><span class="n">add_config</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                         <span class="n">generics</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size_of_data_set</span><span class="o">=</span><span class="n">size_of_data_set</span><span class="p">,</span>
                                       <span class="n">num_of_data_sets</span><span class="o">=</span><span class="n">num_of_data_sets</span><span class="p">,</span>
                                       <span class="n">activate_bug</span><span class="o">=</span><span class="n">activate_bug</span><span class="p">),</span>
                         <span class="n">pre_config</span><span class="o">=</span><span class="n">make_pre_config</span><span class="p">(</span><span class="n">plot_title</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">num_of_data_sets</span><span class="o">=</span><span class="n">num_of_data_sets</span><span class="p">),</span>
                         <span class="n">post_check</span><span class="o">=</span><span class="n">post_check</span><span class="p">)</span>
</pre></div>
</div>
<p>The result is shown in this short clip</p>
<iframe width="560" height="315"
src="https://www.youtube.com/embed/AnlwP3WSA2s" frameborder="0"
allow="accelerometer; autoplay; encrypted-media; gyroscope;
picture-in-picture" allowfullscreen></iframe><p>The good thing about the solutions I provided is that it makes it is
fairly easy to get started. You can download the code and adapt it for
your needs. If you didn’t know about VUnit configurations and arrays
you’ve also learned something that is useful in many other
situations. However, leaving aside my limited Matlab skills, there are
still a number of flaws with this solution. For example</p>
<ul class="simple">
<li><p>With the CSV support provided by VUnit and Matlab it became easy to
split the data into sets and store them in separate files. I would
prefer writing and reading a single open file.</p></li>
<li><p>Copying and modifying code is not good reuse. I need to raise the
abstraction and remove details.</p></li>
<li><p>Responsibility for the plot is all over the place. The testbench is
in charge of the data, the title is set by the Python script, axis
labels are controlled by the M script, and some properties are
hardcoded.</p></li>
</ul>
<p>It seems that I will have to revisit this post. Until then…</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="2017_11_07_vunit_3_0_while_waiting_for_vhdl_2017.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">VUnit 3.0 - While Waiting for VHDL-2017</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="2017_12_14_vunit_bfms_as_simple_as_emailing.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">VUnit BFMs - as Simple as Emailing</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2014-2024, Lars Asplund
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-solid fa-brands fa-twitter" href="https://twitter.com/VUnitFramework" aria-label="Twitter @VUnitFramework"></a>
              <a class="muted-link fa-solid fa-brands fa-gitter" href="https://gitter.im/VUnit/vunit" aria-label="Gitter VUnit/vunit"></a>
              <a class="muted-link fa-solid fa-brands fa-github" href="https://github.com/VUnit/vunit" aria-label="GitHub VUnit/vunit"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">VUnit Matlab Integration</a><ul>
<li><a class="reference internal" href="#the-testbench">The Testbench</a></li>
<li><a class="reference internal" href="#the-run-script">The Run Script</a></li>
<li><a class="reference internal" href="#the-matlab-script">The Matlab Script</a></li>
<li><a class="reference internal" href="#putting-it-all-together">Putting It All Together</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>